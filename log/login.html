<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RAPIDOC</title>
  <link rel="icon" type="image/x-icon" href="./log/favicon.ico">
  <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
  <link rel="stylesheet" href="login.css">
  <script src="https://www.gstatic.com/firebasejs/9.9.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.9.2/firebase-auth-compat.js"></script>
  <meta name="google-signin-client_id" content="646664380070-n07i34glgcc6sanb59p3m1k5k0cgn1v1.apps.googleusercontent.com">
</head>
<body>
  <div class="top-left-corner">
    <a href="/index.html" class="home-button">
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 64 64">
            <path d="M 32 8 C 31.08875 8 30.178047 8.3091875 29.435547 8.9296875 L 8.8007812 26.171875 C 8.0357812 26.810875 7.7634844 27.925203 8.2714844 28.783203 C 8.9184844 29.875203 10.35025 30.088547 11.28125 29.310547 L 12 28.710938 L 12 47 C 12 49.761 14.239 52 17 52 L 47 52 C 49.761 52 52 49.761 52 47 L 52 28.712891 L 52.71875 29.3125 C 53.09275 29.6255 53.546047 29.777344 53.998047 29.777344 C 54.693047 29.777344 55.382672 29.416656 55.763672 28.722656 C 56.228672 27.874656 55.954891 26.803594 55.212891 26.183594 L 52 23.498047 L 52 15 C 52 13.895 51.105 13 50 13 L 48 13 C 46.895 13 46 13.895 46 15 L 46 18.484375 L 34.564453 8.9296875 C 33.821953 8.3091875 32.91125 8 32 8 z M 32 12.152344 C 32.11475 12.152344 32.228766 12.191531 32.322266 12.269531 L 48 25.369141 L 48 46 C 48 47.105 47.105 48 46 48 L 38 48 L 38 34 C 38 32.895 37.105 32 36 32 L 28 32 C 26.895 32 26 32.895 26 34 L 26 48 L 18 48 C 16.895 48 16 47.105 16 46 L 16 25.367188 L 31.677734 12.269531 C 31.771234 12.191531 31.88525 12.152344 32 12.152344 z"></path>
        </svg>
    </a>
  </div>
  <div class="container" id="container">
    <div class="form-container register-container">
      <form action="#" id="registerForm">
        <h1>RAPIDOC</h1>
        <input type="text" id="registerName" placeholder="Name">
        <input type="email" id="registerEmail" placeholder="Email">
        <div class="password-container">
          <input type="password" id="registerPassword" placeholder="Password">
          <span toggle="#registerPassword" class="eye toggle-password">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="24px" height="24px">
              <circle cx="12" cy="12" r="3" />
              <path d="M17.5 12c-1.297 0-2.5-.768-3.5-1.854C12.5 9.768 11.297 9 10 9s-2.5.768-4 1.146c-1 1.086-2.203 1.854-3.5 1.854" />
              <path d="M1 12s4-8 11-8s11 8 11 8s-4 8-11 8s-11-8-11-8z" />
            </svg>
          </span>
        </div>
        <button type="submit">Register</button>
        <span id="registerMessage" style="display: none;">Account created successfully</span>
        <div class="social-container">
          <a href="https://www.facebook.com" class="social" id="fb"><i class="lni lni-facebook-fill"></i></a>
          <a href="https://google.com" class="social" id="goog"><i class="lni lni-google"></i></a>
          <a href="https://www.linkedin.com" class="social" id="lin"><i class="lni lni-linkedin-original"></i></a>
        </div>
      </form>
    </div>

    <div class="form-container login-container">
      <form action="#" id="loginForm">
        <h1>RAPIDOC</h1>
        <input type="email" id="loginEmail" placeholder="Email">
        <div class="password-container">
          <input type="password" id="loginPassword" placeholder="Password">
          <span toggle="#loginPassword" class="eye toggle-password">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="24px" height="24px">
              <circle cx="12" cy="12" r="3" />
              <path d="M17.5 12c-1.297 0-2.5-.768-3.5-1.854C12.5 9.768 11.297 9 10 9s-2.5.768-4 1.146c-1 1.086-2.203 1.854-3.5 1.854" />
              <path d="M1 12s4-8 11-8s11 8 11 8s-4 8-11 8s-11-8-11-8z" />
            </svg>
          </span>
        </div>
        <div class="content">
          <div class="checkbox">
            <input type="checkbox" name="checkbox" id="checkbox">
            <label>Remember me</label>
          </div>
          <div class="pass-link">
            <a href="#">Forgot password?</a>
          </div>
        </div>
        <button type="submit">Login</button>
        <span>or use your account</span>
        <div class="social-container">
          <a href="https://www.facebook.com" class="social" id="fb"><i class="lni lni-facebook-fill"></i></a>
          <a href="https://google.com" class="social" id="goog"><i class="lni lni-google"></i></a>
          <a href="https://www.linkedin.com" class="social" id="lin"><i class="lni lni-linkedin-original"></i></a>
        </div>
      </form>
    </div>

    <div class="overlay-container">
      <div class="overlay">
        <div class="overlay-panel overlay-left">
          <h1 class="title">Hello <br> friends</h1>
          <p>if you have an account, login here and have fun</p>
          <button class="ghost" id="login">Login
            <i class="lni lni-arrow-left login"></i>
          </button>
        </div>
        <div class="overlay-panel overlay-right">
          <h1 class="title">Start your <br> journey now</h1>
          <p>if you don't have an account yet, join us and start your journey.</p>
          <button class="ghost" id="register">Register
            <i class="lni lni-arrow-right register"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  </div>
  <script src="/js/script.js"></script>
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendEmailVerification, reload, deleteUser } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-auth.js";
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: "YOUR_MEASUREMENT_ID" // optional
    };

  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
  
    // Register event
    const registerForm = document.getElementById('registerForm');
    registerForm.addEventListener('submit', async (e) => {
      e.preventDefault();
  
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
  
      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
  
        // Set a timeout for checking email verification
        const timeout = setTimeout(async () => {
          await reload(user);
          if (!user.emailVerified) {
            await deleteUser(user)
              .then(() => {
                alert('Account deleted due to unverified email.');
                location.reload(); // Reload the page after deletion
              })
              .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                alert(errorMessage);
                location.reload(); // Reload the page on error
              });
          }
        }, 30000); // 30 seconds
  
        await sendEmailVerification(user);
        alert('Registration successful! Please check your email to verify your account.');
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        alert(errorMessage);
        location.reload(); // Reload the page on error
      }
    });
  
    // Login event
    const loginForm = document.getElementById('loginForm');
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
  
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
  
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
  
        // Check if email is verified
        await reload(user); // Ensure latest user data is fetched
        if (user.emailVerified) {
          window.location.href = '/index.html'; // Redirect to index.html upon successful login
        } else {
          alert('Please verify your email address.');
        }
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        alert(errorMessage);
        location.reload(); // Reload the page on error
      }
    });
  </script>
</body>
</html>
